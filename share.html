<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>test1</title>
    <script src="./bower_components/angular/angular.min.js"></script>
    <script src="./bower_components/angular-route/angular-route.min.js"></script>
    <script src="./bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="./bower_components/bootstrap/dist/css/bootstrap.min.css"/>
    <script>
        var app =  angular.module('menuApp',['ngRoute']);
        app.config(function($routeProvider){
            $routeProvider.
                    when('/',{
                        templateUrl:'menu.html',
                        controller:'menuCtrl'
                    }).
                    when('/ingredient',{
                        templateUrl:'ingredient.html',
                        controller:'ingredientCtrl'
                    }).
                    when('/recipe',{
                        templateUrl:'recipe.html',
                        controller:'recipeCtrl'
                    }).otherwise({
                        redirectTo:'/'
                    });
        });
        app.factory('cook',function(){
            var ingredients=["beef","chicken","shrimp","blocoli",
                "onion","mushroom","carrot","salmon"],
                recipes=[
                    {
                        name:"cali",
                        ingredients:["beef","onion","carrot","potato"]
                    }
                ],
                tempRecipe=[];
            return{
               getIngredients:function(callback){
                   callback(ingredients);
               },
               getRecipes:function(callback){
                   callback(recipes);
               },
               getTempRecipe:function(callback){
                   callback(tempRecipe);
               }
            }
        });

        app.controller('ingredientCtrl',function($scope,cook){
            cook.getIngredients(function(data){
                $scope.ingredients = data;
            });
            $scope.query='';
            $scope.add = function(name,array){
                if (array.indexOf(name) < 0) {
                    array.push(name);
                    $scope.entered = '';
                    $("p#alert").html("");
                } else {
                    $("p#alert").html("Item already exists!");
                }
            };
            $scope.remove = function(name){
                var i = $scope.ingredients.indexOf(name);
                $scope.ingredients.splice(i,1);
            };
        });
        app.controller('menuCtrl',function($scope,cook){
            cook.getRecipes(function(data){
                $scope.recipes = data;
            });
            $scope.list=[];
            $scope.mSelected=[];
            $scope.sele= function (item) {
                $scope.mSelected.push(item);
                $scope.list=[];
                $scope.detail($scope.mSelected);
            };
            $scope.dele=function(item){
                var i = $scope.mSelected.indexOf(item);
                $scope.mSelected.splice(i,1);
                $scope.list=[];
                $scope.detail($scope.mSelected);
            };
            $scope.add = function(name,array){
                if (array.indexOf(name) < 0) {
                    array.push(name);
                };
            };
            $scope.detail=function(array){
                var x,y;
                for(x in array){
                    for(y in array[x].ingredients){
                       $scope.add(array[x].ingredients[y],$scope.list);
                    }
                }
            }

        });
        app.controller('recipeCtrl',function($scope,cook){
            cook.getTempRecipe(function(data){
                $scope.recipe=data;
            });
            cook.getIngredients(function(data){
                $scope.ingredients = data;
            });
            cook.getRecipes(function(data){
                $scope.recipes = data;
            });
            $scope.add = function(name,array){
                if (array.indexOf(name) < 0) {
                    array.push(name);
                } else {
                    return;
                }
            };
            $scope.remove = function(name,array){
                var i = array.indexOf(name);
                array.splice(i,1);
            };
            $scope.save=function(){
                $scope.recipe1=[];
                while($scope.recipe[0]){
                    $scope.recipe1.push($scope.recipe.shift());
                }
                $scope.recipes.push({name:$scope.entered,
                    ingredients:$scope.recipe1});
                $scope.entered='';
            };
        });

    </script>
    <script>
        $(document).ready(function(){
            $("a").click(function(){
                $(".active").removeClass("active");
                $(this).parent().addClass("active");
            });
        });
    </script>
</head>
<body ng-app="menuApp">
<div class="container">
    <nav class="navbar navbar-default">
        <div class="navbaar-header">
            <a href="#" class="navbar-brand"><h3>Components</h3></a>
        </div>
        <div>
            <ul class="nav navbar-nav">
                <li><a href="#/" ><h3>Menu</h3></a></li>
                <li><a href="#/recipe" ><h3>Recipes</h3></a></li>
                <li><a href="#/ingredient" ><h3>Ingredients</h3></a></li>
            </ul>
        </div>
    </nav>

    <div ng-view>
    </div>
</div>
</body>
</html>